---
title: "TSA Final Project"
author: "Shubhangi Gupta, Aditi Jackson, David Robinson"
date: "2024-03-29"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

## Setup

```{r packages}
# loading packages
library(tidyverse)
library(dplyr)
library(lubridate)
library(readxl)
library(ggplot2)
library(forecast)
library(Kendall)
library(tseries)
library(outliers)
library(smooth)
library(readr)
library(zoo)
library(cowplot)

```

# Data Wrangling

```{r wrangle}
# importing data
transmission_RAW <- read_excel("Data/Raw/Transmission_Lines_1711480217358.xlsx",
                               col_names=TRUE)

#renaming columns, subsetting date and line length columns and dropping NAs
transmission_CLEAN <- transmission_RAW %>%
  select("Line Length (cKM)","Month Of Completion","Year Of Completion (FY)") %>%
  rename("LineLength"= "Line Length (cKM)",
         "Month"="Month Of Completion",
         "Year"="Year Of Completion (FY)")

# checking for N/As
any(is.na(transmission_CLEAN))

#splitting into month and 2-digit year
transmission_CLEAN <- transmission_CLEAN %>%
  separate(col = Month, into = c("Month", "YearSep"), sep = "-")

#transforming to 4-digit year
transmission_CLEAN$four_digit_year <- as.numeric(paste0("20", transmission_CLEAN$YearSep))

#concatenating into month and 4-digit year
transmission_CLEAN <- transmission_CLEAN %>%
  mutate(Date = paste0(Month, sep = "-", four_digit_year))

#converting date column into a date object
transmission_CLEAN$Date <- my(transmission_CLEAN$Date)

# grouping by date and summing up line length
transmission_CLEAN <- transmission_CLEAN %>%
  group_by(Date)%>%
  summarise(TotalLineLength = sum(LineLength)) %>%
  select("TotalLineLength","Date")

#visually inspected data for missing dates

#TO DO -- update per conversation with Luana -- keep as much data as possible
#removing incomplete years 2015 and 2024
transmission_CLEAN <- transmission_CLEAN[c(10:105),]

#TO DO -- research how India defines transmission versus distribution 
#Initial plot
ggplot(transmission_CLEAN,aes(x=Date,y=TotalLineLength))+
 geom_line() +
  geom_smooth(method = lm)

```

# [ADD]

```{r time series}

#creating time series object
transmission_ts <- ts(transmission_CLEAN,start=c(2016,1),end = c(2023,12),frequency = 12)

ts_plot <- autoplot(transmission_ts[,1])

ACF <- Acf(transmission_ts[,1], lag.max = 40, plot=FALSE)
PACF <- Pacf(transmission_ts[,1], lag.max = 40, plot=FALSE)

plot_grid(ts_plot, autoplot(ACF), autoplot(PACF), nrow = 1)

```

## [ADD]

```{r}

#Decompose

#Mann-Kendall and ADF to determine d term of ARIMA

#Deseason as needed

#Fit ARIMA (1,0,0)

```

## [ADD]

```{r}

```

## [ADD]

```{r}

```

## [ADD]

```{r}

```

## [ADD]

```{r}

```

## [ADD]

```{r}

```

